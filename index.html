<html>
    <head>
        <script src="https://telegram.org/js/telegram-web-app.js"></script>
        <title>POC App</title>
    </head>
    <body>
        <h1>Hi there!</h1>
        <p id='mainp'>

        </p>
        <script>
            const urlParams = new URLSearchParams(window.location.search);
            board = document.getElementById("mainp");
            board.innerHTML = "query params: ";
            board.innerHTML = board.innerHTML + urlParams;
            board.innerHTML = board.innerHTML + "<br/>";
            board.innerHTML = board.innerHTML + window.Telegram.WebApp.initData;
	    board.innerHTML = board.innerHTML + "<br/>";
	    board.innerHTML = board.innerHTML + "Startparam: ";
	    let startParam = window.Telegram.WebApp.initDataUnsafe.start_param;
	    board.innerHTML = board.innerHTML + startParam;
	    board.innerHTML = board.innerHTML + "<br/>";
	    board.innerHTML = board.innerHTML + JSON.stringify(window.Telegram.WebApp.initDataUnsafe);
	    console.log(JSON.stringify(window.Telegram.WebApp.initDataUnsafe));
	    console.log("DONE");
        </script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Check if Telegram WebApp is available
    if (window.Telegram && window.Telegram.WebApp) {
      // Extract the data
      const tgInitData = window.Telegram.WebApp.initData || "";
      const startParam = (window.Telegram.WebApp.initDataUnsafe && window.Telegram.WebApp.initDataUnsafe.start_param) || "";

      // Prepare the data to be sent
	const postData = {
	        tg_initdata: tgInitData
	      };
      if (startParam) {
	      postData.start_param = startParam;
      }
	console.log("hhhh");
	    console.log(postData);
      // Send the data to the specified URL
      const url = "https://tonplus-partnership.runflare.run/api/v1/integration/e523df42-315b-4be9-8d66-9486ab6fe6ba/"; // Replace with your target URL
      fetch(url, {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(postData)
      })
      .then(response => {
        if (response.ok) {
          console.log("Data sent successfully");
        } else {
          console.error("Failed to send data:", response.status, response.statusText);
        }
      })
      .catch(error => {
        console.error("Error sending data:", error);
      });
    } else {
      console.error("Telegram WebApp is not available.");
    }
  });
</script>
    </body>
</html>
