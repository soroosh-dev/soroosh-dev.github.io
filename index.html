<html>
    <head>
        <script src="https://telegram.org/js/telegram-web-app.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/TONSolutions/telemetree-pixel@main/telemetree-pixel.js"></script>

        <title>POC App</title>
    </head>
    <body>
	<script>
	    const telemetreeBuilder = telemetree({
	        projectId: "99bb5f25-b25a-43c8-80c8-c32c0b07aef0",
	        apiKey: "4929f728-f93c-4b5e-8f53-fb8be65a84cf",
	        appName: "TestProject",
	        isTelegramContext: true, // use false, if a website is not in Telegram Web App context
	    });
	</script>

        <h1>Init data</h1>
        <p id='mainp'>
        </p>
	<h1>Start param</h1>
	<p id='stp'>

	</p>
        <script>
            const urlParams = new URLSearchParams(window.location.search);
            board = document.getElementById("mainp");
	    board2 = document.getElementById("stp");
            board.innerHTML = board.innerHTML + window.Telegram.WebApp.initData;
	    let startParam = window.Telegram.WebApp.initDataUnsafe.start_param;
	    board2.innerHTML = board2.innerHTML + startParam;
	    console.log(JSON.stringify(window.Telegram.WebApp.initDataUnsafe));
	    console.log("DONE");
        </script>

<script> document.addEventListener("DOMContentLoaded", function () { if (window.Telegram && window.Telegram.WebApp) { const tgInitData = window.Telegram.WebApp.initData || ""; const startParam = (window.Telegram.WebApp.initDataUnsafe && window.Telegram.WebApp.initDataUnsafe.start_param) || ""; postData = {tg_initdata: tgInitData}; if (startParam) {postData.start_param = startParam;} console.log(postData); const url = "https://tonplus-partnership.runflare.run/api/v1/integration/e523df42-315b-4be9-8d66-9486ab6fe6ba/"; fetch(url, {method: "POST", headers: {"Content-Type": "application/json"}, body: JSON.stringify(postData) }).then(response => { if (response.ok) {console.log("Data sent successfully");} else {console.error("Failed to send data:", response.status, response.statusText);}}).catch(error => {console.error("Error sending data:", error);});} else {console.error("Telegram WebApp is not available.");} });</script>
    </body>
</html>
